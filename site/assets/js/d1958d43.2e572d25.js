"use strict";(self.webpackChunkdrand_docs=self.webpackChunkdrand_docs||[]).push([[4115],{8288:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>a});var r=s(4848),t=s(8453);const i={id:"4-0-ops-guide",title:"4.0 OPERATORS GUIDE",description:"A guide for drand node operators."},d="4.0 OPERATORS GUIDE",o={id:"ops-guide/4-0-ops-guide",title:"4.0 OPERATORS GUIDE",description:"A guide for drand node operators.",source:"@site/docs/04_ops-guide/04-00-OPERATORS_GUIDE.md",sourceDirName:"04_ops-guide",slug:"/ops-guide/4-0-ops-guide",permalink:"/docs/ops-guide/4-0-ops-guide",draft:!1,unlisted:!1,editUrl:"https://github.com/drand/drand-docs/tree/main/docs/04_ops-guide/04-00-OPERATORS_GUIDE.md",tags:[],version:"current",frontMatter:{id:"4-0-ops-guide",title:"4.0 OPERATORS GUIDE",description:"A guide for drand node operators."},sidebar:"docsSidebar",previous:{title:"4.0 OPERATORS GUIDE",permalink:"/docs/category/40-operators-guide"},next:{title:"4.1 Deployment",permalink:"/docs/ops-guide/4-1-ops-guide-deployment"}},l={},a=[{value:"Key Objectives for League of Entropy Operators:",id:"key-objectives-for-league-of-entropy-operators",level:2}];function c(e){const n={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"40-operators-guide",children:"4.0 OPERATORS GUIDE"})}),"\n",(0,r.jsx)(n.h1,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["A drand ",(0,r.jsx)(n.strong,{children:"Network"})," is composed of individual and independent drand ",(0,r.jsx)(n.strong,{children:"Nodes"})," that generate randomness by networking with other distributed nodes. The randomness is published to the world with the help of drand ",(0,r.jsx)(n.strong,{children:"Relays"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"key-objectives-for-league-of-entropy-operators",children:"Key Objectives for League of Entropy Operators:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Objective"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Security"}),(0,r.jsx)(n.td,{children:"Ensure a secure, DDoS-resistant stack that withstands targeted attacks without compromising private key material."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Performance"}),(0,r.jsx)(n.td,{children:"Provide a fast service that scales to serve hundreds of thousands of clients efficiently."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Diversity"}),(0,r.jsx)(n.td,{children:"Create a diverse setup with multiple endpoints and access methods to ensure reliable randomness consumption, even in degraded network conditions."})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://lh7-us.googleusercontent.com/oJ3VshPm9XDtJqI5qlUuC8cNQ1DOw6RtS-rP9q7JHwJMG8Z6IxgsvDLovQTUhLNIsbtJ-PG7vyoufZOj6DCZ6loOCMHKSbYh0QvRYbY2tVeOfilaewNm12lRoM18TK_OAADq5lsmydz_RRI1epWleyNtaKz4fKw",children:"A high-level view of a simple drand stack"})}),"\n",(0,r.jsx)(n.p,{children:"A high-level view of a simple drand stack"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://lh7-us.googleusercontent.com/0dTQEtQyYTdw8W8kzzKms5o2fx7XlXZIcZXXm7B2N0U7ZfXaHIquajtW4KlOm2Yg28zKcu3aItyAXEegPZ-IML4tR2Wr6vqFdmHqF1NWQL1ML7Bbdi-XQa6FFOnNQchbmkUn8nCX4gJ5SgjHjnjJYbqfiJ_lH8I",children:"https://lh7-us.googleusercontent.com/0dTQEtQyYTdw8W8kzzKms5o2fx7XlXZIcZXXm7B2N0U7ZfXaHIquajtW4KlOm2Yg28zKcu3aItyAXEegPZ-IML4tR2Wr6vqFdmHqF1NWQL1ML7Bbdi-XQa6FFOnNQchbmkUn8nCX4gJ5SgjHjnjJYbqfiJ_lH8I"})}),"\n",(0,r.jsx)(n.h1,{id:"guidelines-for-drand-nodes",children:"Guidelines for drand Nodes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Must be isolated from the public internet."}),"\n",(0,r.jsx)(n.li,{children:"Whitelist incoming TLS-encrypted connections from other drand Nodes using a dedicated firewall instance, which can also perform TLS termination as needed."}),"\n",(0,r.jsx)(n.li,{children:"Outgoing connections should originate from static IP(s) that other operators can whitelist."}),"\n",(0,r.jsx)(n.li,{children:"drand nodes do not offer API service publicly; rely on drand Relays and CDNs."}),"\n",(0,r.jsx)(n.li,{children:"Whitelist or authenticate access from Relays and CDN endpoints."}),"\n"]}),"\n",(0,r.jsx)(n.h1,{id:"guidelines-for-drand-relays",children:"Guidelines for drand Relays"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Encourage the use of Relays to distribute randomness."}),"\n",(0,r.jsx)(n.li,{children:"Relays can provide an HTTP endpoint or use a libp2p-based PubSub system for distribution."}),"\n",(0,r.jsx)(n.li,{children:"Relays should be independent of the drand Node and not co-located on the same machine."}),"\n",(0,r.jsx)(n.li,{children:"PubSub-enabled relays should maintain a unique libp2p Peer ID."}),"\n",(0,r.jsx)(n.li,{children:"HTTP-enabled relays are stateless and can be horizontally scaled."}),"\n"]}),"\n",(0,r.jsx)(n.h1,{id:"use-of-content-distribution-networks-cdns",children:"Use of Content Distribution Networks (CDNs)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Provide HTTP(S) API access to randomness using a CDN linked to Nodes. ",(0,r.jsx)(n.em,{children:"Note: Do not use CDNs operated by other LoE members. (i.e. Cloudflare)"})]}),"\n",(0,r.jsx)(n.li,{children:"Configure CDN to cache drand HTTP endpoints, as drand produces immutable values periodically."}),"\n",(0,r.jsx)(n.li,{children:"Use dedicated HTTP-enabled Relays for CDN requests to minimize direct access to drand Nodes."}),"\n"]}),"\n",(0,r.jsx)(n.h1,{id:"operation-of-a-drand-stack",children:"Operation of a drand Stack"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ensure a known set of node operators are responsible and reachable."}),"\n",(0,r.jsx)(n.li,{children:"Monitor infrastructure with extracted logs and pushed monitoring information."}),"\n",(0,r.jsx)(n.li,{children:"Ensure logs are collected externally and ensure both system level metrics as well as applications level metrics are monitored."}),"\n",(0,r.jsx)(n.li,{children:"Additionally, follow security recommendations below:"}),"\n"]}),"\n",(0,r.jsx)(n.h1,{id:"security-recommendations",children:"Security Recommendations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Area"}),(0,r.jsx)(n.th,{children:"Recommendations"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SSH Access"}),(0,r.jsx)(n.td,{children:"- Use a bastion node for SSH access, whitelisting operator IPs or VPN endpoints."})]})})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Disable sudo and root access on bastion nodes."}),"\n",(0,r.jsx)(n.li,{children:"Enforce key-based SSH login and disable password authentication."}),"\n",(0,r.jsx)(n.li,{children:"Enable 2FA for all machine logins."}),"\n",(0,r.jsx)(n.li,{children:"Use a pin-protected physical device (e.g. Yubikey) for SSH key storage. |\n| Firewall Configuration | - Thoroughly test allowlist enforcement, allowing only incoming connections on the drand-grpc port."}),"\n",(0,r.jsx)(n.li,{children:"Use dedicated reverse-proxy/firewall machines without exposing SSH access."}),"\n",(0,r.jsx)(n.li,{children:"Ensure reverse proxies for HTTP-relays are on separate machines. |\n| External Services | - Enable MFA for all infrastructure/cloud provider logins."}),"\n",(0,r.jsx)(n.li,{children:"Rotate API keys frequently."}),"\n",(0,r.jsx)(n.li,{children:"Limit user permissions and avoid shared logins."}),"\n",(0,r.jsx)(n.li,{children:"Use an email list for main account notifications. |\n| Drand Machines | - Ensure operating system is up-to-date with latest security patches."}),"\n",(0,r.jsx)(n.li,{children:"Run the drand node in isolation with dedicated system users."}),"\n",(0,r.jsx)(n.li,{children:"Encrypt disks containing drand configuration files."}),"\n",(0,r.jsx)(n.li,{children:"Limit external access strictly to operators."}),"\n",(0,r.jsx)(n.li,{children:"Inform network partners immediately in case of compromise. |"}),"\n"]}),"\n",(0,r.jsx)(n.h1,{id:"resource-recommendations",children:"Resource Recommendations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Resource"}),(0,r.jsx)(n.th,{children:"For a drand node"}),(0,r.jsx)(n.th,{children:"For a Publicly-accessible HTTP Relay"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Compute"}),(0,r.jsx)(n.td,{children:"Comparable to x86-64 at the AWS \u2018micro\u2019 tier"}),(0,r.jsx)(n.td,{children:"Comparable to x86-64 at the AWS \u2018micro\u2019 tier"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Storage"}),(0,r.jsx)(n.td,{children:"At least 64GB of persistent storage"}),(0,r.jsx)(n.td,{children:"N/A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Storage I/O"}),(0,r.jsx)(n.td,{children:"No special provisioning required"}),(0,r.jsx)(n.td,{children:"N/A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Network Bandwidth"}),(0,r.jsx)(n.td,{children:"Minimum 1Mbps of dedicated bandwidth"}),(0,r.jsx)(n.td,{children:"100Mbps of network traffic"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Memory"}),(0,r.jsx)(n.td,{children:"32GB"}),(0,r.jsx)(n.td,{children:"32GB to keep all rounds cached in memory"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Hosting Capacity"}),(0,r.jsx)(n.td,{children:"At least 100Gbps of available peered or transit bandwidth"}),(0,r.jsx)(n.td,{children:"N/A"})]})]})]}),"\n",(0,r.jsx)(n.h1,{id:"monitoring-recommendations",children:"Monitoring Recommendations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Area"}),(0,r.jsx)(n.th,{children:"Recommendations"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Logs"}),(0,r.jsx)(n.td,{children:"\u2022 Collect and ship logs to an external service."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Monitor log collection and notify operators if logs are not received."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Enable pam_tty_audit for logging user actions."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Collect and monitor load balancer/firewall/CDN logs."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Metrics"}),(0,r.jsx)(n.td,{children:"\u2022 Monitor common machine metrics (CPU, Disk usage, Memory, Bandwidth)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Enable Prometheus metrics endpoints for drand applications."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Scrape metrics locally and push to a remote service."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"API Monitoring"}),(0,r.jsx)(n.td,{children:"\u2022 Monitor /health and /public/latest endpoints for node and relay health."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Use /info endpoint for load-balancer health checks."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Alerts"}),(0,r.jsx)(n.td,{children:"Set up alerts for increased error log entries, failed metric pushes, panic lines, successful and failed SSH logins, CPU usage spikes, reboots, and application restarts."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Dashboards"}),(0,r.jsx)(n.td,{children:"Create dashboards for metrics like CPU, load, uptime, connections, memory usage, disk usage, API requests, beacon discrepancy, and process details."})]})]})]}),"\n",(0,r.jsx)(n.h1,{id:"operation-recommendations",children:"Operation Recommendations"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Area"}),(0,r.jsx)(n.th,{children:"Recommendations"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Deployments and Maintenance"}),(0,r.jsx)(n.td,{children:"\u2022 Communicate maintenance to partners and users."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Avoid maintenance overlaps."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Monitor log messages and dashboards during deployments."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Backups"}),(0,r.jsx)(n.td,{children:"\u2022 Securely back up key and group folders before network events."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Regularly back up node configurations to prevent data loss."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CDN and HTTP Relays"}),(0,r.jsx)(n.td,{children:"\u2022 Never co-locate HTTP relays with the drand node."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Use CDNs to cache responses and prevent direct DDoS attacks on the drand daemon."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Limit HTTP relay traffic to CDN only."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Gossip Relays"}),(0,r.jsx)(n.td,{children:"\u2022 Ensure gossip relays are not co-located with drand nodes or HTTP relays."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Configure dnsaddr entries for gossip relays."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Protect gossip relay identities and monitor their performance."}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Status Monitoring"}),(0,r.jsx)(n.td,{children:"\u2022 Monitor nodes using appropriate tools and report their status to the collective status page."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u2022 Ensure latency monitoring is enabled and accessible by the League of Entropy. This refers to making GRPC exposed Prometheus metrics available for latency monitoring. Ensure your metrics are publicly accessible to enable comprehensive monitoring by the League of Entropy."}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>o});var r=s(6540);const t={},i=r.createContext(t);function d(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);