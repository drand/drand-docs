<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Timelock Encryption is now supported on drand mainnet | drand</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.drand.love/img/league-members.avif"><meta data-rh="true" name="twitter:image" content="https://docs.drand.love/img/league-members.avif"><meta data-rh="true" property="og:url" content="https://docs.drand.love/blog/timelock-encryption-is-now-supported-on-drand-mainnet"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Timelock Encryption is now supported on drand mainnet | drand"><meta data-rh="true" name="description" content="The drand team has been busy during the past year working on delivering an exciting new feature: Timelock Encryption. Timelock encryption enables you to encrypt a message that cannot be decrypted by anyone until a specified time in the future."><meta data-rh="true" property="og:description" content="The drand team has been busy during the past year working on delivering an exciting new feature: Timelock Encryption. Timelock encryption enables you to encrypt a message that cannot be decrypted by anyone until a specified time in the future."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-03-27T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Conferences-and-Events,Features,News"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.drand.love/blog/timelock-encryption-is-now-supported-on-drand-mainnet"><link data-rh="true" rel="alternate" href="https://docs.drand.love/blog/timelock-encryption-is-now-supported-on-drand-mainnet" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.drand.love/blog/timelock-encryption-is-now-supported-on-drand-mainnet" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://docs.drand.love/blog/timelock-encryption-is-now-supported-on-drand-mainnet","mainEntityOfPage":"https://docs.drand.love/blog/timelock-encryption-is-now-supported-on-drand-mainnet","url":"https://docs.drand.love/blog/timelock-encryption-is-now-supported-on-drand-mainnet","headline":"Timelock Encryption is now supported on drand mainnet","name":"Timelock Encryption is now supported on drand mainnet","description":"The drand team has been busy during the past year working on delivering an exciting new feature: Timelock Encryption. Timelock encryption enables you to encrypt a message that cannot be decrypted by anyone until a specified time in the future.","datePublished":"2023-03-27T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://docs.drand.love/blog","name":"drand Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="drand RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="drand Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PH6HJ6ECV2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PH6HJ6ECV2",{})</script><link rel="stylesheet" href="/assets/css/styles.7acb8680.css">
<script src="/assets/js/runtime~main.02d3e84e.js" defer="defer"></script>
<script src="/assets/js/main.1808307d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/drand-logo.avif" alt="drand Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/drand-logo.avif" alt="drand Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">drand</b></a><a class="navbar__item navbar__link" href="/docs/home">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/drand/drand-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div style="width:100%;max-height:500px;overflow:hidden"><img src="/img/banner.avif" alt="Banner" style="width:100%;height:100%;object-fit:cover;object-position:center bottom"></div><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/fastnet-sunsetting-dates-set">fastnet sunsetting dates are set</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/create-a-notion-widget">Notion Widget for drand Public Randomness!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/retro-drand-testnet-outage-2024-02-21">Retro on the drand testnet outage of Feb 21, 2024</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/quicknet-live-on-loe-mainnet">quicknet is live!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/announcing-randamu">Announcing Randamu!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/fastnet-to-be-sunset">fastnet to be sunset, long live quicknet</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/announcing-drand-code-walkthrough">Announcing the drand Code Walkthroughs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/drand-explainer-for-begginers">drand Explainer for Beginners</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/security-assessment-of-tlock">Security Assessment of tlock</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/randomness-summit-tokyo-2023">Randomness Summit Tokyo 2023</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/timelock-encryption-is-now-supported-on-drand-mainnet">Timelock Encryption is now supported on drand mainnet</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/drand-on-filecoin-virtual-machine-FVM-draffle">drand on Filecoin Virtual Machine (FVM) - draffle</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/auttomata-network-joins-the-league-of-entropy">Automata Network Joins the League of Entropy!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/a-guide-on-how-to-use-drand">A Guide on how to use drand</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ipfs-force-joins-the-league-of-entropy">IPFS Force joins the League of Entropy!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/drand-2022-year-in-review-&amp;-our-2023-roadmap">drand: 2022 Year in Review &amp; our 2023 Roadmap</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cryptosat-takes-drand-to-space">CryptoSat takes drand to Space!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/observing-randomness">Observing Randomness</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/drand-at-northsec">drand @ NorthSec</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/storswift-joins-the-league-of-entropy">StorSwift joins the League of Entropy!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/multi-frequency-support-and-timelock-encryption-are-coming-to-drand">Multi-Frequency Support &amp; Timelock Encryption are coming to drand!</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/the-value-of-drand-part-2-of-2">The Value of drand (Part 2 of 2)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/the-value-of-drand-part-1-of-2">Discover The Value of drand (Part 1 of 2)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/drand-celebrates-one-year-as-a-randomness-service">drand celebrates One Year as a Randomness Service!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/the-league-of-entrophy-welcomes-quantum-resistant-ledger">The League of Entrophy welcomes Quantum Resistant Ledger (QRL)</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2020</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/join-th-randomness-revolution-drand-is-hiring">Join the Randomness Revolution: Drand is hiring!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/drand-v1.0-and-the-league-of-entropy-two-weeks-in">drand v1.0 and the League of Entropy: Two Weeks In</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/the-league-of-entropy-launches-drand">The League of Entropy launches drand v1.0 to become the Internet’s first production-grade, publicly verifiable, randomness beacon!</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Timelock Encryption is now supported on drand mainnet</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-03-27T00:00:00.000Z">March 27, 2023</time> · <!-- -->8 min read</div></header><div id="__blog-post-container" class="markdown"><p>The drand team has been busy during the past year working on delivering an exciting new feature: <strong>Timelock Encryption</strong>. Timelock encryption enables you to encrypt a message that cannot be decrypted by anyone until a specified time in the future.</p>
<!-- -->
<p>You might have heard about it from us already, since we were proud to present not just one, but <em>three</em> new open-source projects in August 2022, bringing a new very exciting feature called “timelock encryption” to our drand testnet!</p>
<p>Well, wait no more: we have now finally reached “General Availability” and our <em>audited</em> Timelock Encryption scheme is <strong>now compatible with the drand mainnet</strong>, thanks to our newly launched <code>fastnet</code> network which we’ll discuss quickly in this post as well.</p>
<p>Thanks to the team&#x27;s work, you can now use these features in many ways:</p>
<ul>
<li><a href="https://timevault.drand.love/" target="_blank" rel="noopener noreferrer"><strong>Our Timevault web-demo</strong></a> using <code>tlock-js</code> to perform timelock encryption easily in your browser, locally.</li>
<li><code>tlock</code>, a <a href="https://github.com/drand/tlock/" target="_blank" rel="noopener noreferrer"><strong>Go library doing Timelock encryption</strong></a> by relying on drand’s beacon signatures, along with <code>tle</code> - a CLI tool allowing you to use timelock encryption just like you would use <code>gpg</code> or <code>age</code>.</li>
<li><code>tlock-js</code>, a <a href="https://github.com/drand/tlock-js/" target="_blank" rel="noopener noreferrer"><strong>TS library doing the same</strong></a> for your browser apps.</li>
<li>Using the unchained drand beacons from our new <code>fastnet</code> network: <a href="https://api.drand.sh/dbd506d6ef76e5f386f41c651dcb808c5bcbd75471cc4eafa3f4df7ad4e4c493/public/latest" target="_blank" rel="noopener noreferrer">https://api.drand.sh/dbd506d6ef76e5f386f41c651dcb808c5bcbd75471cc4eafa3f4df7ad4e4c493/public/latest</a></li>
</ul>
<aside><p>⚠️ NOTE: <code>fastnet</code> has been deprecated in favor of <code>quicknet</code> since the original publication of this blog post.</p></aside>
<p>These were already <a href="https://www.youtube.com/watch?t=1652&amp;v=IW7sdSd2wOQ&amp;feature=youtu.be" target="_blank" rel="noopener noreferrer"><strong>presented at DEF CON</strong></a> when we launched them on our testnet. Check the talk if you want more details about possible applications and the history behind Timelock Encryption.</p>
<p>More recently, we released a <a href="https://eprint.iacr.org/2023/189" target="_blank" rel="noopener noreferrer"><strong>pre-print paper</strong></a> explaining the details of our timelock scheme and we have a talk scheduled at Real World Crypto tomorrow, on March 29th, 2023 where we’ll explain more in depth how <strong>we transformed the League of Entropy</strong> and drand into the first practical <strong>Timelock Encryption service</strong> globally available with a <strong>100% uptime history</strong> over the past 3 years!</p>
<p>But for today let’s first see what this “Timelock Encryption” we’re talking about is.</p>
<p>P.S.: If this has piqued your interest and you’d rather watch a video about how this works, you can also find more technical explanations about what is coming next in this <a href="https://www.youtube.com/watch?v=Zgsv4LY0Sn0" target="_blank" rel="noopener noreferrer"><strong>Research Seminar</strong></a> that we gave in September!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="timelock-encryption"><strong>Timelock Encryption</strong><a href="#timelock-encryption" class="hash-link" aria-label="Direct link to timelock-encryption" title="Direct link to timelock-encryption">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="drand-background"><strong>Drand background</strong><a href="#drand-background" class="hash-link" aria-label="Direct link to drand-background" title="Direct link to drand-background">​</a></h3>
<p>In order to understand how the system works, we need to first recall a few things about how drand functions…</p>
<p>First things first, let’s recall that <code>drand</code>, which stands for “<strong>distributed randomness</strong>” (and thus pronounced “dee-rand”), is our very own <a href="https://github.com/drand/drand" target="_blank" rel="noopener noreferrer"><strong>open-source software</strong></a> meant to create distributed randomness networks. These networks emit <strong>random “beacons” at a given frequency</strong> in a way that you never need to trust any single party in the network, and can <em><strong>verify</strong></em> that you actually have random values as long as you trust there is <strong>never a threshold number of malicious parties</strong> in the network, thus the security of the threshold BLS signature scheme holds.</p>
<p>To accomplish this drand relies on the threshold BLS signature scheme and its security proof that tells us BLS signatures are indistinguishable from random ones (in the group of all possible signatures). At each epoch, the members of a drand network work together to create an aggregated BLS signature on the message <strong>m = H(round)}</strong>. An important point here for what comes next is that the <strong>message is predictable</strong> according to the target round at a time T (in other words, there is a mapping between time and round numbers, since the network operates at a fixed frequency), when we’re using drand in the so-called unchained mode that <a href="/blog/multi-frequency-support-and-timelock-encryption-are-coming-to-drand"><strong>we presented in a post last year</strong></a>.</p>
<p>You can learn more about drand and how it works under the hood in our documentation: <a href="https://docs.drand.love/docs/concepts/2-1-concepts-cryptography" target="_blank" rel="noopener noreferrer"><strong>Cryptography Page</strong></a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-league-of-entropy"><strong>The League of Entropy</strong><a href="#the-league-of-entropy" class="hash-link" aria-label="Direct link to the-league-of-entropy" title="Direct link to the-league-of-entropy">​</a></h3>
<p>The League of Entropy is a consortium of organisations that decided, back in 2019, to start running a global drand network in order to provide free, unbiased, and verifiable public randomness for anyone to use. Since 2019, the League has been growing steadily, with new members joining it regularly and thus increasing the security and trust we can have in the League. You can read more about the League on Cloudflare’s website: <a href="https://www.cloudflare.com/leagueofentropy/" target="_blank" rel="noopener noreferrer"><strong>https://www.cloudflare.com/leagueofentropy/</strong></a></p>
<p>As of March 2023, the League is constituted of over 21 drand nodes operated by 18 organisations, with a threshold of over 50%, and you can follow our blog to see when new partners are joining the League: <a href="https://docs.drand.love/blog" target="_blank" rel="noopener noreferrer">Blog</a></p>
<p>In case you were worried after reading our paper, know that whenever new members join the League, we conduct a so-called “resharing” of the League’s group secret key using verifiable secret sharing. This means that <strong>the public keys of the drand networks we run never change</strong> and it is not going to cause an incompatibility issue with our timelock scheme.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="our-timed-release-encryption-scheme"><strong>Our “timed release encryption” scheme</strong><a href="#our-timed-release-encryption-scheme" class="hash-link" aria-label="Direct link to our-timed-release-encryption-scheme" title="Direct link to our-timed-release-encryption-scheme">​</a></h3>
<p>Our timelock scheme, also sometimes called a “timed release encryption” (TRE) scheme, is a direct application of the <a href="https://crypto.stanford.edu/~dabo/papers/bfibe.pdf" target="_blank" rel="noopener noreferrer"><strong>Identity Based Encryption scheme</strong></a> (IBE) from Boneh et al. (section 4.2) to the threshold BLS signature setting of drand.</p>
<p>In IBE, participants are referred to via their <strong>identity</strong> which can be an email, a name, etc. and anyone can encrypt a message to any identity, even if the recipient is not “registered” with the system. This works because there is a Private Key Generator (PKG) service that distributes the required secret keys to participants depending on their identity.</p>
<p>As it turns out, the League of Entropy is basically acting as a <strong>“Distributed PKG” network</strong> because they’re using the BLS scheme to sign messages and, (as already denoted in the initial 2001 IBE paper), the decryption keys of their IBE scheme can be used as signatures over a given identity, which is exactly what the BLS scheme is accomplishing.</p>
<p>Moreover, it uses <strong>the round number as the identity</strong>, <strong>and the corresponding signature becomes the private key to decrypt.</strong> In short:</p>
<p>Public key = <strong>round number</strong></p>
<p>Private key = <strong>signature over the round number</strong></p>
<p>Given this, the flow is as follows:</p>
<ul>
<li>Anyone can encrypt a message towards a specific round X in advance</li>
<li>When the time has come, the network will generate the BLS signature (i.e. the <em>private key)</em> and release it publicly</li>
<li>Anybody can retrieve the BLS signature of the beacon produced at round X and decrypt any message that was encrypted towards that round X.</li>
</ul>
<p>For more technical information about how this works, you can <strong>check our pre-print paper</strong> about our Timelock Encryption scheme on ePrint <a href="https://eprint.iacr.org/2023/189" target="_blank" rel="noopener noreferrer"><strong>here</strong></a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hybrid-encryption"><strong>Hybrid Encryption</strong><a href="#hybrid-encryption" class="hash-link" aria-label="Direct link to hybrid-encryption" title="Direct link to hybrid-encryption">​</a></h2>
<p>Because our timed release encryption scheme allows users to <strong>encrypt a fixed sized message</strong>, and also to achieve better performance in general, it relies on “<strong>Hybrid encryption</strong>” to encrypt arbitrary data more easily. Hybrid encryption means that we are using an asymmetric encryption scheme to <strong>encrypt a Data Encryption Key (DEK)</strong> used to subsequently encrypt the actual data we want to transmit with a symmetric encryption scheme. This is commonly known as “wrapping a key”, and it&#x27;s how modern public key encryption schemes function to encrypt more data than their “block size”. It has the benefit of being much faster than doing asymmetric encryption of each chunk of data. Typically, the DEK is an AES or ChaCha key, both being blazingly fast symmetric encryption schemes compared to the public key scheme used to encrypt the DEK.</p>
<p>Hybrid encryption also allows users to significantly reduce the size of a ciphertext meant for multiple recipients, since one only needs to wrap the DEK for different recipients while the bulk of the encrypted data remains the same for all recipients since it was encrypted with a single symmetric key.</p>
<p>In practice, we decided the easiest way to implement this was to rely on the existing <a href="https://github.com/FiloSottile/age" target="_blank" rel="noopener noreferrer"><strong><code>age</code></strong></a> library and tool to create new types of “recipients” and “identities” for it using our timelock scheme to wrap symmetric encryption keys. This is made easier with <code>age</code> through the notion of “stanzas”, data itself is encrypted using a <code>filekey</code> which is then encrypted (wrapped) using one or multiple stanzas following the battle-tested hybrid encryption technique.</p>
<p>We tried to stay pretty close to the age-plugin format in order to possibly adapt this new scheme into a plugin, perhaps sometime in the future. Here is our custom tlock stanza:</p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> tlock </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">roundnumber</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">chainhash</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">timelocked</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">fileKey</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">given</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">roundnumber</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">and</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">chainhash</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tlock"><strong>tlock</strong><a href="#tlock" class="hash-link" aria-label="Direct link to tlock" title="Direct link to tlock">​</a></h2>
<p>We have implemented the scheme in a <strong>Golang library</strong> <a href="https://github.com/drand/tlock" target="_blank" rel="noopener noreferrer"><strong>tlock</strong></a> and a <strong>Typescript library</strong> <a href="https://github.com/drand/tlock-js" target="_blank" rel="noopener noreferrer"><strong>tlock-js</strong></a>.</p>
<p>For convenience, we have implemented:</p>
<ul>
<li><strong>a web demo</strong> at <a href="https://timevault.drand.love/" target="_blank" rel="noopener noreferrer"><strong>https://timevault.drand.love/</strong></a> using our tlock-js library</li>
<li><strong>a CLI utility</strong> <code>tle</code> that you can find on the <a href="https://github.com/drand/tlock#install-or-build-the-cli" target="_blank" rel="noopener noreferrer"><strong>tlock repo</strong></a></li>
</ul>
<p>The <code>tlock</code> Go library is a pure Go library implemented on top of an implementation of <a href="https://github.com/drand/kyber/tree/master/encrypt/ibe" target="_blank" rel="noopener noreferrer"><strong>IBE in our Kyber library</strong></a> fork and instantiated using <a href="https://github.com/kilic/bls12-381" target="_blank" rel="noopener noreferrer"><strong>kilic’s BLS12-381</strong></a> elliptic curve library. The <code>tle</code> CLI tool is built following the same kind of flags as used in <code>age</code> itself. Here’s a quick demo using it:</p>
<p><img decoding="async" loading="lazy" src="https://user-images.githubusercontent.com/181501/177999855-cc1cfef7-ee1c-4193-bea7-4ee2e689f2d1.svg" alt="https://user-images.githubusercontent.com/181501/177999855-cc1cfef7-ee1c-4193-bea7-4ee2e689f2d1.svg" class="img_ev3q"></p>
<p>The <code>tlock-js</code> is a pure Typescript implementation of timed encryption using the drand network. Like the <code>tlock</code> Go library, it uses <a href="http://age-encryption.org/" target="_blank" rel="noopener noreferrer"><strong>Age encryption</strong></a> under the hood to perform symmetric encryption on a given payload using <a href="https://en.wikipedia.org/wiki/ChaCha20-Poly1305" target="_blank" rel="noopener noreferrer"><strong>chacha20-poly1305</strong></a> and wraps the symmetric key using timelock encryption. This ciphertext is then (optionally) encoded using ascii armor making it easy to move around and display - similar to what PGP and other utilities do.</p>
<p>The library only has a handful of dependencies:</p>
<ul>
<li>some of the noble crypto libraries (the de facto standard for many algorithms in js/ts)</li>
<li>Stablelib’s chacha20-poly1305 implementation</li>
<li>a polyfill for node’s <code>Buffer</code></li>
</ul>
<p>It’s available on npm at <a href="https://www.npmjs.com/package/tlock-js" target="_blank" rel="noopener noreferrer"><strong>https://www.npmjs.com/package/tlock-js</strong></a> and github at <a href="https://github.com/drand/tlock-js" target="_blank" rel="noopener noreferrer"><strong>https://github.com/drand/tlock-js</strong></a> and is used by our <a href="https://timevault.drand.love/" target="_blank" rel="noopener noreferrer"><strong>Timevault web demo</strong></a>!</p>
<p>Finally, to ensure the best security guarantees possible to our users, we had both <code>tlock</code> and <code>tlock-js</code> go through a code assessment by a renowned cybersecurity company, which we’ll be releasing shortly as well.</p>
<h1><strong>Our new <code>fastnet</code> network</strong></h1>
<p>The best part about our timelock solution is that it is live on our mainnet! You can try it in your browser here: <a href="https://timevault.drand.love/" target="_blank" rel="noopener noreferrer"><strong>https://timevault.drand.love/</strong></a></p>
<p>This is possible because the League of Entropy actually launched a new drand mainnet network, on March 1st, 2023: the <code>fastnet</code> 🏎️ network! It is readily available through our mainnet endpoints: <a href="https://api.drand.sh/dbd506d6ef76e5f386f41c651dcb808c5bcbd75471cc4eafa3f4df7ad4e4c493/info" target="_blank" rel="noopener noreferrer"><strong>https://api.drand.sh/dbd506d6ef76e5f386f41c651dcb808c5bcbd75471cc4eafa3f4df7ad4e4c493/info</strong></a></p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-property property" style="color:#36acaa">&quot;public_key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;a0b862a7527fee3a731bcb59280ab6abd62d5c0b6ea03dc4ddf6612fdfc9d01f01c31542541771903475eb1ec6615f8d0df0b8b6dce385811d6dcf8cbefb8759e5e616a3dfd054c928940766d9a5b9db91e3b697e5d70a975181e007f87fca5e&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-property property" style="color:#36acaa">&quot;period&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-property property" style="color:#36acaa">&quot;genesis_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1677685200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-property property" style="color:#36acaa">&quot;hash&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;dbd506d6ef76e5f386f41c651dcb808c5bcbd75471cc4eafa3f4df7ad4e4c493&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-property property" style="color:#36acaa">&quot;groupHash&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;a81e9d63f614ccdb144b8ff79fbd4d5a2d22055c0bfe4ee9a8092003dab1c6c0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-property property" style="color:#36acaa">&quot;schemeID&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;bls-unchained-on-g1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-property property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string-property property" style="color:#36acaa">&quot;beaconID&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;fastnet&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It is running at a 3 second frequency, which is 10 times faster than our previous chained <code>default</code> mainnet network, and it uses G1 for signatures, which means its random beacons have signatures that are 50% smaller! It is also running in unchained mode, and thus enables timelock encryption on mainnet!</p>
<p>You can start building your very own sealed-bid auction system on top of it, <a href="https://research.kudelskisecurity.com/2023/02/22/releasing-a-timelocked-responsible-disclosure/" target="_blank" rel="noopener noreferrer"><strong>do a timelocked responsible disclosure</strong></a>, or use it as a <a href="https://gwern.net/self-decrypting#uses" target="_blank" rel="noopener noreferrer"><strong>deadman’s switch by encrypting your bitcoin private key</strong></a> with it and giving the timelocked ciphertext to your heirs, while having the full security of running on the League of Entropy mainnet instead of on our testnet, as was the case until now.</p>
<p>Expect another blog post in the coming months with more details about the G1/G2 swap in <code>fastnet</code>, and what it means for BLS signatures, and for the applications using drand beacons. (Hints: smaller footprint, better performance and, where applicable, much cheaper gas costs!)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="related-works"><strong>Related works</strong><a href="#related-works" class="hash-link" aria-label="Direct link to related-works" title="Direct link to related-works">​</a></h2>
<p>Our timelock work has already gathered significant interest from the community and we’re happy to report that there already exists:</p>
<ul>
<li>a <a href="https://github.com/timoth-y/tlock-rs" target="_blank" rel="noopener noreferrer"><strong>tlock-rs library</strong></a> prototype by <a href="https://twitter.com/timoethey" target="_blank" rel="noopener noreferrer"><strong>Timofey Luin</strong></a> supporting only the timelock part of our scheme without the hybrid encryption using age and not compatible with our <code>tle</code> tool. Timofey then used it to benchmark arithmetic circuits doing <a href="https://github.com/timoftime/zk-timelock" target="_blank" rel="noopener noreferrer"><strong>verifiable timelock encryption</strong></a> with Arkworks, cool stuff!</li>
<li>the <a href="https://github.com/thibmeu/tlock-rs" target="_blank" rel="noopener noreferrer"><strong>tlock_age library</strong></a> by <a href="https://twitter.com/thibmeu" target="_blank" rel="noopener noreferrer"><strong>Thibault Meunier</strong></a>, which started as a fork of the tlock-rs library adding age support to it and making it compatible with the age-based scheme implemented in our <code>tlock</code> and <code>tlock-js</code> libraries as well as in our <code>tle</code> tool. Thibault also changed the API significantly and is looking at migrating to a much faster Rust BLS12-381 implementation. If you’re looking at using timelock in Rust, search no more!</li>
<li>a <a href="https://github.com/thibmeu/drand-rs" target="_blank" rel="noopener noreferrer"><strong>CLI tool in Rust</strong></a>, called <code>dee</code>, also by <a href="https://twitter.com/thibmeu" target="_blank" rel="noopener noreferrer"><strong>Thibault</strong></a>, that uses his library in order to be compatible with <code>tle</code> but that also has cool drand-related features to get verifiable, public randomness. It also has a different set of flags.</li>
</ul>
<p>We are also aware of a few blockchain ecosystems that are currently looking into building on top of the BLS signatures emitted by the League of Entropy in order to achieve their own timed release encryption scheme. Stay tuned for more timelock-related news in the coming months!</p>
<p>Finally, don’t hesitate to <a href="https://join.slack.com/t/drandworkspace/shared_invite/zt-19u4rf6if-bf7lxIvF2zYn4~TrBwfkiA" target="_blank" rel="noopener noreferrer"><strong>join our drand Slack Workspace</strong></a> to discuss timelock encryption, or share with us your cool use cases for it, or follow us on our <a href="https://twitter.com/drand_loe" target="_blank" rel="noopener noreferrer"><strong>newly created @drand_loe Twitter account</strong></a> to stay tuned with the latest news from the drand team. Until next time!</p>
<hr></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a title="conferences and events tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/conferences-and-events">Conferences-and-Events</a></li><li class="tag_QGVx"><a title="begginer tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/features">Features</a></li><li class="tag_QGVx"><a title="news tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/news">News</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/drand/drand-docs/tree/master/blog/2023-03-27-timelock-encryption-is-now-supported-on-drand-mainnet.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/randomness-summit-tokyo-2023"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Randomness Summit Tokyo 2023</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/drand-on-filecoin-virtual-machine-FVM-draffle"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">drand on Filecoin Virtual Machine (FVM) - draffle</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#timelock-encryption" class="table-of-contents__link toc-highlight"><strong>Timelock Encryption</strong></a><ul><li><a href="#drand-background" class="table-of-contents__link toc-highlight"><strong>Drand background</strong></a></li><li><a href="#the-league-of-entropy" class="table-of-contents__link toc-highlight"><strong>The League of Entropy</strong></a></li><li><a href="#our-timed-release-encryption-scheme" class="table-of-contents__link toc-highlight"><strong>Our “timed release encryption” scheme</strong></a></li></ul></li><li><a href="#hybrid-encryption" class="table-of-contents__link toc-highlight"><strong>Hybrid Encryption</strong></a></li><li><a href="#tlock" class="table-of-contents__link toc-highlight"><strong>tlock</strong></a></li><li><a href="#related-works" class="table-of-contents__link toc-highlight"><strong>Related works</strong></a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/home">Dev Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/drand" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/drandworkspace/shared_invite/zt-2p00bn43o-qALTK5RZEIK3I4fIO9h8dQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/drand/drand" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Apache 2.0 and/or MIT Licensed 2024 Randamu, Inc.™ Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>